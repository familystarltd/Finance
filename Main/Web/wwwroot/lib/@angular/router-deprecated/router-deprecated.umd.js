var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs/Subject"),require("rxjs/observable/PromiseObservable"),require("rxjs/operator/toPromise"),require("rxjs/Observable"),require("@angular/common"),require("@angular/core"),require("@angular/platform-browser")):"function"==typeof define&&define.amd?define(["exports","rxjs/Subject","rxjs/observable/PromiseObservable","rxjs/operator/toPromise","rxjs/Observable","@angular/common","@angular/core","@angular/platform-browser"],e):e((t.ng=t.ng||{},t.ng.router_deprecated=t.ng.router_deprecated||{}),t.Rx,t.Rx,t.Rx.Observable.prototype,t.Rx,t.ng.common,t.ng.core,t.ng.platformBrowser)}(this,function(t,e,n,r,i,o,u,a){"use strict";function s(t){return t.name?t.name:typeof t}function c(t){return void 0!==t&&null!==t}function h(t){return void 0===t||null===t}function l(t){return"string"==typeof t}function f(t){return"function"==typeof t}function p(t){return f(t)}function m(t){return"object"==typeof t&&null!==t}function g(t){return Array.isArray(t)}function v(){}function y(t){return h(t)?null:t}function d(t,e){if(c(t))for(var n=0;n<t.length;n++){var r=t[n];g(r)?d(r,e):e.push(r)}return e}function _(t){var e=[];return h(t)?[]:(K.forEach(t,function(t,n){e.push(t===!0?n:n+"="+t)}),e)}function R(t,e){return void 0===e&&(e="&"),_(t).join(e)}function w(t){var e=q.firstMatch(st,t);return c(e)?e[0]:""}function x(t){var e=q.firstMatch(ct,t);return c(e)?e[0]:""}function P(t){return h(t)?null:t.toString()}function b(t){return h(t)?null:(t=F.replaceAll(t,Ut,"%25"),t=F.replaceAll(t,zt,"%2F"),t=F.replaceAll(t,Lt,"%28"),t=F.replaceAll(t,Bt,"%29"),t=F.replaceAll(t,Mt,"%3B"))}function A(t){return h(t)?null:(t=F.replaceAll(t,Wt,";"),t=F.replaceAll(t,Ft,")"),t=F.replaceAll(t,qt,"("),t=F.replaceAll(t,Vt,"/"),t=F.replaceAll(t,Ht,"%"))}function S(t,e){if(t instanceof it){var n=O(t.loader,e);return new it({path:t.path,loader:n,name:t.name,data:t.data,useAsDefault:t.useAsDefault})}if(t instanceof nt||t instanceof ot||t instanceof rt)return t;if(+!!t.component+ +!!t.redirectTo+ +!!t.loader!=1)throw new Z('Route config should contain exactly one "component", "loader", or "redirectTo" property.');if(t.as&&t.name)throw new Z('Route config should contain exactly one "as" or "name" property.');if(t.as&&(t.name=t.as),t.loader){var n=O(t.loader,e);return new it({path:t.path,loader:n,name:t.name,data:t.data,useAsDefault:t.useAsDefault})}if(t.aux)return new rt({path:t.aux,component:t.component,name:t.name});if(t.component){if("object"==typeof t.component){var r=t.component;if("constructor"==r.type)return new nt({path:t.path,component:r.constructor,name:t.name,data:t.data,useAsDefault:t.useAsDefault});if("loader"==r.type)return new it({path:t.path,loader:r.loader,name:t.name,data:t.data,useAsDefault:t.useAsDefault});throw new Z('Invalid component type "'+r.type+'". Valid types are "constructor" and "loader".')}return new nt(t)}return t.redirectTo?new ot({path:t.path,redirectTo:t.redirectTo}):t}function O(t,e){return function(){return t().then(function(t){return e.configFromComponent(t),t})}}function C(t,e){if(!p(t))throw new Z('Component for route "'+e+'" is not defined, or is not a class.')}function I(t){var e=[];return t.forEach(function(t){if(l(t)){var n=t;e=e.concat(n.split("/"))}else e.push(t)}),e}function T(t){if(t=t.filter(function(t){return c(t)}),0==t.length)return null;if(1==t.length)return t[0];var e=t[0],n=t.slice(1);return n.reduce(function(t,e){return-1==j(e.specificity,t.specificity)?e:t},e)}function j(t,e){for(var n=W.min(t.length,e.length),r=0;n>r;r+=1){var i=F.charCodeAt(t,r),o=F.charCodeAt(e,r),u=o-i;if(0!=u)return u}return t.length-e.length}function k(t,e){if(p(t)){var n=u.reflector.annotations(t);if(c(n))for(var r=0;r<n.length;r++){var i=n[r];if(i instanceof tt)throw new Z('Child routes are not allowed for "'+e+'". Use "..." on the parent\'s route path.')}}}function N(t,e){return e instanceof u.Type?t.name in e.prototype:!1}function D(t){for(var e=u.reflector.annotations(t),n=0;n<e.length;n+=1){var r=e[n];if(r instanceof ne)return r.fn}return null}function E(t,e){var n=le;return h(t.component)?n:(c(t.child)&&(n=E(t.child,c(e)?e.child:null)),n.then(function(n){if(0==n)return!1;if(t.component.reuse)return!0;var r=D(t.component.componentType);return c(r)?r(t.component,c(e)?e.component:null):!0}))}function U(t,e,n,r){var i=new pe(t,e,n);return r.registerDisposeListener(function(){return i.dispose()}),i}function z(t){if(0==t.componentTypes.length)throw new Z("Bootstrap at least one component before injecting Router.");return t.componentTypes[0]}var L;L="undefined"==typeof window?"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:global:window;var B=L,M=Function,W=B.Math;B.assert=function(t){};var F=function(){function t(){}return t.fromCharCode=function(t){return String.fromCharCode(t)},t.charCodeAt=function(t,e){return t.charCodeAt(e)},t.split=function(t,e){return t.split(e)},t.equals=function(t,e){return t===e},t.stripLeft=function(t,e){if(t&&t.length){for(var n=0,r=0;r<t.length&&t[r]==e;r++)n++;t=t.substring(n)}return t},t.stripRight=function(t,e){if(t&&t.length){for(var n=t.length,r=t.length-1;r>=0&&t[r]==e;r--)n--;t=t.substring(0,n)}return t},t.replace=function(t,e,n){return t.replace(e,n)},t.replaceAll=function(t,e,n){return t.replace(e,n)},t.slice=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=null),t.slice(e,null===n?void 0:n)},t.replaceAllMapped=function(t,e,n){return t.replace(e,function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return t.splice(-2,2),n(t)})},t.contains=function(t,e){return-1!=t.indexOf(e)},t.compare=function(t,e){return e>t?-1:t>e?1:0},t}(),q=function(){function t(){}return t.create=function(t,e){return void 0===e&&(e=""),e=e.replace(/g/g,""),new B.RegExp(t,e+"g")},t.firstMatch=function(t,e){return t.lastIndex=0,t.exec(e)},t.test=function(t,e){return t.lastIndex=0,t.test(e)},t.matcher=function(t,e){return t.lastIndex=0,{re:t,input:e}},t.replaceAll=function(t,e,n){var r=t.exec(e),i="";t.lastIndex=0;for(var o=0;r;)i+=e.substring(o,r.index),i+=n(r),o=r.index+r[0].length,t.lastIndex=o,r=t.exec(e);return i+=e.substring(o)},t}(),V=function(){function t(){}return t.next=function(t){return t.re.exec(t.input)},t}(),H=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t}(),Q=function(){function t(){}return t.resolve=function(t){return Promise.resolve(t)},t.reject=function(t,e){return Promise.reject(t)},t.catchError=function(t,e){return t["catch"](e)},t.all=function(t){return 0==t.length?Promise.resolve([]):Promise.all(t)},t.then=function(t,e,n){return t.then(e,n)},t.wrap=function(t){return new Promise(function(e,n){try{e(t())}catch(r){n(r)}})},t.scheduleMicrotask=function(e){t.then(t.resolve(null),e,function(t){})},t.isPromise=function(t){return t instanceof Promise},t.completer=function(){return new H},t}(),J=function(){function t(){}return t.subscribe=function(t,e,n,r){return void 0===r&&(r=function(){}),n="function"==typeof n&&n||v,r="function"==typeof r&&r||v,t.subscribe({next:e,error:n,complete:r})},t.isObservable=function(t){return!!t.subscribe},t.hasSubscribers=function(t){return t.observers.length>0},t.dispose=function(t){t.unsubscribe()},t.callNext=function(t,e){t.next(e)},t.callEmit=function(t,e){t.emit(e)},t.callError=function(t,e){t.error(e)},t.callComplete=function(t){t.complete()},t.fromPromise=function(t){return n.PromiseObservable.create(t)},t.toPromise=function(t){return r.toPromise.call(t)},t}(),G=function(t){function e(e){void 0===e&&(e=!0),t.call(this),this._isAsync=e}return __extends(e,t),e.prototype.emit=function(e){t.prototype.next.call(this,e)},e.prototype.next=function(e){t.prototype.next.call(this,e)},e.prototype.subscribe=function(e,n,r){var i,o=function(t){return null},u=function(){return null};return e&&"object"==typeof e?(i=this._isAsync?function(t){setTimeout(function(){return e.next(t)})}:function(t){e.next(t)},e.error&&(o=this._isAsync?function(t){setTimeout(function(){return e.error(t)})}:function(t){e.error(t)}),e.complete&&(u=this._isAsync?function(){setTimeout(function(){return e.complete()})}:function(){e.complete()})):(i=this._isAsync?function(t){setTimeout(function(){return e(t)})}:function(t){e(t)},n&&(o=this._isAsync?function(t){setTimeout(function(){return n(t)})}:function(t){n(t)}),r&&(u=this._isAsync?function(){setTimeout(function(){return r()})}:function(){r()})),t.prototype.subscribe.call(this,i,o,u)},e}(e.Subject),$=B.Map,Y=B.Set,K=(function(){try{if(1===new $([[1,2]]).size)return function(t){return new $(t)}}catch(t){}return function(t){for(var e=new $,n=0;n<t.length;n++){var r=t[n];e.set(r[0],r[1])}return e}}(),function(){try{if(new $(new $))return function(t){return new $(t)}}catch(t){}return function(t){var e=new $;return t.forEach(function(t,n){e.set(n,t)}),e}}(),function(){return(new $).keys().next?function(t){for(var e,n=t.keys();!(e=n.next()).done;)t.set(e.value,null)}:function(t){t.forEach(function(e,n){t.set(n,null)})}}(),function(){try{if((new $).values().next)return function(t,e){return Array.from(e?t.values():t.keys())}}catch(t){}return function(t,e){var n=X.createFixedSize(t.size),r=0;return t.forEach(function(t,i){n[r]=e?t:i,r++}),n}}(),function(){function t(){}return t.create=function(){return{}},t.contains=function(t,e){return t.hasOwnProperty(e)},t.get=function(t,e){return t.hasOwnProperty(e)?t[e]:void 0},t.set=function(t,e,n){t[e]=n},t.keys=function(t){return Object.keys(t)},t.values=function(t){return Object.keys(t).reduce(function(e,n){return e.push(t[n]),e},[])},t.isEmpty=function(t){for(var e in t)return!1;return!0},t["delete"]=function(t,e){delete t[e]},t.forEach=function(t,e){for(var n in t)t.hasOwnProperty(n)&&e(t[n],n)},t.merge=function(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n},t.equals=function(t,e){var n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(var i,o=0;o<n.length;o++)if(i=n[o],t[i]!==e[i])return!1;return!0},t}()),X=function(){function t(){}return t.createFixedSize=function(t){return new Array(t)},t.createGrowableSize=function(t){return new Array(t)},t.clone=function(t){return t.slice(0)},t.forEachWithIndex=function(t,e){for(var n=0;n<t.length;n++)e(t[n],n)},t.first=function(t){return t?t[0]:null},t.last=function(t){return t&&0!=t.length?t[t.length-1]:null},t.indexOf=function(t,e,n){return void 0===n&&(n=0),t.indexOf(e,n)},t.contains=function(t,e){return-1!==t.indexOf(e)},t.reversed=function(e){var n=t.clone(e);return n.reverse()},t.concat=function(t,e){return t.concat(e)},t.insert=function(t,e,n){t.splice(e,0,n)},t.removeAt=function(t,e){var n=t[e];return t.splice(e,1),n},t.removeAll=function(t,e){for(var n=0;n<e.length;++n){var r=t.indexOf(e[n]);t.splice(r,1)}},t.remove=function(t,e){var n=t.indexOf(e);return n>-1?(t.splice(n,1),!0):!1},t.clear=function(t){t.length=0},t.isEmpty=function(t){return 0==t.length},t.fill=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=null),t.fill(e,n,null===r?t.length:r)},t.equals=function(t,e){if(t.length!=e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0},t.slice=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=null),t.slice(e,null===n?void 0:n)},t.splice=function(t,e,n){return t.splice(e,n)},t.sort=function(t,e){c(e)?t.sort(e):t.sort()},t.toString=function(t){return t.toString()},t.toJSON=function(t){return JSON.stringify(t)},t.maximum=function(t,e){if(0==t.length)return null;for(var n=null,r=-(1/0),i=0;i<t.length;i++){var o=t[i];if(!h(o)){var u=e(o);u>r&&(n=o,r=u)}}return n},t.flatten=function(t){var e=[];return d(t,e),e},t.addAll=function(t,e){for(var n=0;n<e.length;n++)t.push(e[n])},t}(),Z=(function(){var t=new Y([1,2,3]);return 3===t.size?function(t){return new Y(t)}:function(t){var e=new Y(t);if(e.size!==t.length)for(var n=0;n<t.length;n++)e.add(t[n]);return e}}(),function(t){function e(e){void 0===e&&(e="--"),t.call(this,e),this.message=e,this.stack=new Error(e).stack}return __extends(e,t),e.prototype.toString=function(){return this.message},e}(Error)),tt=function(){function t(t){this.configs=t}return t}(),et=function(){function t(t){var e=t.name,n=t.useAsDefault,r=t.path,i=t.regex,o=t.serializer,u=t.data;this.name=e,this.useAsDefault=n,this.path=r,this.regex=i,this.serializer=o,this.data=u}return t}(),nt=function(t){function e(e){var n=e.name,r=e.useAsDefault,i=e.path,o=e.regex,u=e.serializer,a=e.data,s=e.component;t.call(this,{name:n,useAsDefault:r,path:i,regex:o,serializer:u,data:a}),this.aux=null,this.component=s}return __extends(e,t),e}(et),rt=function(t){function e(e){var n=e.name,r=e.useAsDefault,i=e.path,o=e.regex,u=e.serializer,a=e.data,s=e.component;t.call(this,{name:n,useAsDefault:r,path:i,regex:o,serializer:u,data:a}),this.component=s}return __extends(e,t),e}(et),it=function(t){function e(e){var n=e.name,r=e.useAsDefault,i=e.path,o=e.regex,u=e.serializer,a=e.data,s=e.loader;t.call(this,{name:n,useAsDefault:r,path:i,regex:o,serializer:u,data:a}),this.aux=null,this.loader=s}return __extends(e,t),e}(et),ot=function(t){function e(e){var n=e.name,r=e.useAsDefault,i=e.path,o=e.regex,u=e.serializer,a=e.data,s=e.redirectTo;t.call(this,{name:n,useAsDefault:r,path:i,regex:o,serializer:u,data:a}),this.redirectTo=s}return __extends(e,t),e}(et),ut=function(){function t(t,e,n,r){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r={}),this.path=t,this.child=e,this.auxiliary=n,this.params=r}return t.prototype.toString=function(){return this.path+this._matrixParamsToString()+this._auxToString()+this._childString()},t.prototype.segmentToString=function(){return this.path+this._matrixParamsToString()},t.prototype._auxToString=function(){return this.auxiliary.length>0?"("+this.auxiliary.map(function(t){return t.toString()}).join("//")+")":""},t.prototype._matrixParamsToString=function(){var t=R(this.params,";");return t.length>0?";"+t:""},t.prototype._childString=function(){return c(this.child)?"/"+this.child.toString():""},t}(),at=function(t){function e(e,n,r,i){void 0===n&&(n=null),void 0===r&&(r=[]),void 0===i&&(i=null),t.call(this,e,n,r,i)}return __extends(e,t),e.prototype.toString=function(){return this.path+this._auxToString()+this._childString()+this._queryParamsToString()},e.prototype.segmentToString=function(){return this.path+this._queryParamsToString()},e.prototype._queryParamsToString=function(){return h(this.params)?"":"?"+R(this.params)},e}(ut),st=q.create("^[^\\/\\(\\)\\?;=&#]+"),ct=q.create("^[^\\(\\)\\?;&#]+"),ht=function(){function t(){}return t.prototype.peekStartsWith=function(t){return this._remaining.startsWith(t)},t.prototype.capture=function(t){if(!this._remaining.startsWith(t))throw new Z('Expected "'+t+'".');this._remaining=this._remaining.substring(t.length)},t.prototype.parse=function(t){return this._remaining=t,""==t||"/"==t?new ut(""):this.parseRoot()},t.prototype.parseRoot=function(){this.peekStartsWith("/")&&this.capture("/");var t=w(this._remaining);this.capture(t);var e=[];this.peekStartsWith("(")&&(e=this.parseAuxiliaryRoutes()),this.peekStartsWith(";")&&this.parseMatrixParams();var n=null;this.peekStartsWith("/")&&!this.peekStartsWith("//")&&(this.capture("/"),n=this.parseSegment());var r=null;return this.peekStartsWith("?")&&(r=this.parseQueryParams()),new at(t,n,e,r)},t.prototype.parseSegment=function(){if(0==this._remaining.length)return null;this.peekStartsWith("/")&&this.capture("/");var t=w(this._remaining);this.capture(t);var e=null;this.peekStartsWith(";")&&(e=this.parseMatrixParams());var n=[];this.peekStartsWith("(")&&(n=this.parseAuxiliaryRoutes());var r=null;return this.peekStartsWith("/")&&!this.peekStartsWith("//")&&(this.capture("/"),r=this.parseSegment()),new ut(t,r,n,e)},t.prototype.parseQueryParams=function(){var t={};for(this.capture("?"),this.parseQueryParam(t);this._remaining.length>0&&this.peekStartsWith("&");)this.capture("&"),this.parseQueryParam(t);return t},t.prototype.parseMatrixParams=function(){for(var t={};this._remaining.length>0&&this.peekStartsWith(";");)this.capture(";"),this.parseParam(t);return t},t.prototype.parseParam=function(t){var e=w(this._remaining);if(!h(e)){this.capture(e);var n=!0;if(this.peekStartsWith("=")){this.capture("=");var r=w(this._remaining);c(r)&&(n=r,this.capture(n))}t[e]=n}},t.prototype.parseQueryParam=function(t){var e=w(this._remaining);if(!h(e)){this.capture(e);var n=!0;if(this.peekStartsWith("=")){this.capture("=");var r=x(this._remaining);c(r)&&(n=r,this.capture(n))}t[e]=n}},t.prototype.parseAuxiliaryRoutes=function(){var t=[];for(this.capture("(");!this.peekStartsWith(")")&&this._remaining.length>0;)t.push(this.parseSegment()),this.peekStartsWith("//")&&this.capture("//");return this.capture(")"),t},t}(),lt=new ht,ft=function(){function t(t){this.params=t}return t.prototype.get=function(t){return y(K.get(this.params,t))},t}(),pt=function(){function t(t){void 0===t&&(t={}),this.data=t}return t.prototype.get=function(t){return y(K.get(this.data,t))},t}(),mt=new pt,gt=function(){function t(t,e,n){this.component=t,this.child=e,this.auxInstruction=n}return Object.defineProperty(t.prototype,"urlPath",{get:function(){return c(this.component)?this.component.urlPath:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"urlParams",{get:function(){return c(this.component)?this.component.urlParams:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"specificity",{get:function(){var t="";return c(this.component)&&(t+=this.component.specificity),c(this.child)&&(t+=this.child.specificity),t},enumerable:!0,configurable:!0}),t.prototype.toRootUrl=function(){return this.toUrlPath()+this.toUrlQuery()},t.prototype._toNonRootUrl=function(){return this._stringifyPathMatrixAuxPrefixed()+(c(this.child)?this.child._toNonRootUrl():"")},t.prototype.toUrlQuery=function(){return this.urlParams.length>0?"?"+this.urlParams.join("&"):""},t.prototype.replaceChild=function(t){return new vt(this.component,t,this.auxInstruction)},t.prototype.toUrlPath=function(){return this.urlPath+this._stringifyAux()+(c(this.child)?this.child._toNonRootUrl():"")},t.prototype.toLinkUrl=function(){return this.urlPath+this._stringifyAux()+(c(this.child)?this.child._toLinkUrl():"")+this.toUrlQuery()},t.prototype._toLinkUrl=function(){return this._stringifyPathMatrixAuxPrefixed()+(c(this.child)?this.child._toLinkUrl():"")},t.prototype._stringifyPathMatrixAuxPrefixed=function(){var t=this._stringifyPathMatrixAux();return t.length>0&&(t="/"+t),t},t.prototype._stringifyMatrixParams=function(){return this.urlParams.length>0?";"+this.urlParams.join(";"):""},t.prototype._stringifyPathMatrixAux=function(){return h(this.component)?"":this.urlPath+this._stringifyMatrixParams()+this._stringifyAux()},t.prototype._stringifyAux=function(){var t=[];return K.forEach(this.auxInstruction,function(e,n){t.push(e._stringifyPathMatrixAux())}),t.length>0?"("+t.join("//")+")":""},t}(),vt=function(t){function e(e,n,r){t.call(this,e,n,r)}return __extends(e,t),e.prototype.resolveComponent=function(){return Q.resolve(this.component)},e}(gt),yt=function(t){function e(e,n){t.call(this,e,n,{})}return __extends(e,t),e.prototype.toLinkUrl=function(){return""},e.prototype._toLinkUrl=function(){return""},e}(vt),dt=function(t){function e(e,n,r){void 0===n&&(n=""),void 0===r&&(r=[]),t.call(this,null,null,{}),this._resolver=e,this._urlPath=n,this._urlParams=r}return __extends(e,t),Object.defineProperty(e.prototype,"urlPath",{get:function(){return c(this.component)?this.component.urlPath:c(this._urlPath)?this._urlPath:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"urlParams",{get:function(){return c(this.component)?this.component.urlParams:c(this._urlParams)?this._urlParams:[]},enumerable:!0,configurable:!0}),e.prototype.resolveComponent=function(){var t=this;return c(this.component)?Q.resolve(this.component):this._resolver().then(function(e){return t.child=c(e)?e.child:null,t.component=c(e)?e.component:null})},e}(gt),_t=function(t){function e(e,n,r,i){t.call(this,e,n,r),this._specificity=i}return __extends(e,t),Object.defineProperty(e.prototype,"specificity",{get:function(){return this._specificity},enumerable:!0,configurable:!0}),e}(vt),Rt=function(){function t(t,e,n,r,i,o,u,a){void 0===u&&(u=null),this.urlPath=t,this.urlParams=e,this.componentType=r,this.terminal=i,this.specificity=o,this.params=u,this.routeName=a,this.reuse=!1,this.routeData=c(n)?n:mt}return t}(),wt=function(){function t(){}return t}(),xt=function(t){function e(e,n,r){t.call(this),this.instruction=e,this.remaining=n,this.remainingAux=r}return __extends(e,t),e}(wt),Pt=function(t){function e(e,n){t.call(this),this.redirectTo=e,this.specificity=n}return __extends(e,t),e}(wt),bt=function(){function t(t,e){this._pathRecognizer=t,this.redirectTo=e,this.hash=this._pathRecognizer.hash}return Object.defineProperty(t.prototype,"path",{get:function(){return this._pathRecognizer.toString()},set:function(t){throw new Z("you cannot set the path of a RedirectRule directly")},enumerable:!0,configurable:!0}),t.prototype.recognize=function(t){var e=null;return c(this._pathRecognizer.matchUrl(t))&&(e=new Pt(this.redirectTo,this._pathRecognizer.specificity)),Q.resolve(e)},t.prototype.generate=function(t){throw new Z("Tried to generate a redirect.")},t}(),At=function(){function t(t,e,n){this._routePath=t,this.handler=e,this._routeName=n,this._cache=new $,this.specificity=this._routePath.specificity,this.hash=this._routePath.hash,this.terminal=this._routePath.terminal}return Object.defineProperty(t.prototype,"path",{get:function(){return this._routePath.toString()},set:function(t){throw new Z("you cannot set the path of a RouteRule directly")},enumerable:!0,configurable:!0}),t.prototype.recognize=function(t){var e=this,n=this._routePath.matchUrl(t);return h(n)?null:this.handler.resolveComponentType().then(function(t){var r=e._getInstruction(n.urlPath,n.urlParams,n.allParams);return new xt(r,n.rest,n.auxiliary)})},t.prototype.generate=function(t){var e=this._routePath.generateUrl(t),n=e.urlPath,r=e.urlParams;return this._getInstruction(n,_(r),t)},t.prototype.generateComponentPathValues=function(t){return this._routePath.generateUrl(t)},t.prototype._getInstruction=function(t,e,n){if(h(this.handler.componentType))throw new Z("Tried to get instruction before the type was loaded.");var r=t+"?"+e.join("&");if(this._cache.has(r))return this._cache.get(r);var i=new Rt(t,e,this.handler.data,this.handler.componentType,this.terminal,this.specificity,n,this._routeName);return this._cache.set(r,i),i},t}(),St=function(){function t(t,e){void 0===e&&(e=null),this._loader=t,this._resolvedComponent=null,this.data=c(e)?new pt(e):mt}return t.prototype.resolveComponentType=function(){var t=this;return c(this._resolvedComponent)?this._resolvedComponent:this._resolvedComponent=this._loader().then(function(e){return t.componentType=e,e})},t}(),Ot=function(){function t(t,e){this.componentType=t,this._resolvedComponent=null,this._resolvedComponent=Q.resolve(t),this.data=c(e)?new pt(e):mt}return t.prototype.resolveComponentType=function(){return this._resolvedComponent},t}(),Ct=function(){function t(t){var e=this;this.map={},this.keys={},c(t)&&K.forEach(t,function(t,n){e.map[n]=c(t)?t.toString():null,e.keys[n]=!0})}return t.prototype.get=function(t){return K["delete"](this.keys,t),this.map[t]},t.prototype.getUnused=function(){var t=this,e={},n=K.keys(this.keys);return n.forEach(function(n){return e[n]=K.get(t.map,n)}),e},t}(),It=function(){function t(t,e,n,r,i){this.urlPath=t,this.urlParams=e,this.allParams=n,this.auxiliary=r,this.rest=i}return t}(),Tt=function(){function t(t,e){this.urlPath=t,this.urlParams=e}return t}(),jt=function(){function t(){this.name="",this.specificity="",this.hash="..."}return t.prototype.generate=function(t){return""},t.prototype.match=function(t){return!0},t}(),kt=function(){function t(t){this.path=t,this.name="",this.specificity="2",this.hash=t}return t.prototype.match=function(t){return t==this.path},t.prototype.generate=function(t){return this.path},t}(),Nt=function(){function t(t){this.name=t,this.specificity="1",this.hash=":"}return t.prototype.match=function(t){return t.length>0},t.prototype.generate=function(t){if(!K.contains(t.map,this.name))throw new Z("Route generator for '"+this.name+"' was not included in parameters passed.");return b(P(t.get(this.name)))},t}();Nt.paramMatcher=/^:([^\/]+)$/g;var Dt=function(){function t(t){this.name=t,this.specificity="0",this.hash="*"}return t.prototype.match=function(t){return!0},t.prototype.generate=function(t){return P(t.get(this.name))},t}();Dt.wildcardMatcher=/^\*([^\/]+)$/g;var Et=function(){function t(t){this.routePath=t,this.terminal=!0,this._assertValidPath(t),this._parsePathString(t),this.specificity=this._calculateSpecificity(),this.hash=this._calculateHash();var e=this._segments[this._segments.length-1];this.terminal=!(e instanceof jt)}return t.prototype.matchUrl=function(t){for(var e,n=t,r={},i=[],o=0;o<this._segments.length;o+=1){var u=this._segments[o];if(e=n,u instanceof jt)break;if(c(e)){if(u instanceof Dt){r[u.name]=e.toString(),i.push(e.toString()),n=null;break}if(i.push(e.path),u instanceof Nt)r[u.name]=A(e.path);else if(!u.match(e.path))return null;n=e.child}else if(!u.match(""))return null}if(this.terminal&&c(n))return null;var a=i.join("/"),s=[],h=[],l=r;if(c(e)){var f=t instanceof at?t:e;c(f.params)?(l=K.merge(f.params,r),h=_(f.params)):l=r,s=e.auxiliary}return new It(a,h,l,s,n)},t.prototype.generateUrl=function(t){for(var e=new Ct(t),n=[],r=0;r<this._segments.length;r++){var i=this._segments[r];i instanceof jt||n.push(i.generate(e))}var o=n.join("/"),u=e.getUnused(),a=u;return new Tt(o,a)},t.prototype.toString=function(){return this.routePath},t.prototype._parsePathString=function(t){t.startsWith("/")&&(t=t.substring(1));var e=t.split("/");this._segments=[];for(var n=e.length-1,r=0;n>=r;r++){var i,o=e[r];if(c(i=q.firstMatch(Nt.paramMatcher,o)))this._segments.push(new Nt(i[1]));else if(c(i=q.firstMatch(Dt.wildcardMatcher,o)))this._segments.push(new Dt(i[1]));else if("..."==o){if(n>r)throw new Z('Unexpected "..." before the end of the path for "'+t+'".');this._segments.push(new jt)}else this._segments.push(new kt(o))}},t.prototype._calculateSpecificity=function(){var t,e,n=this._segments.length;if(0==n)e+="2";else for(e="",t=0;n>t;t++)e+=this._segments[t].specificity;return e},t.prototype._calculateHash=function(){var t,e=this._segments.length,n=[];for(t=0;e>t;t++)n.push(this._segments[t].hash);return n.join("/")},t.prototype._assertValidPath=function(e){if(F.contains(e,"#"))throw new Z('Path "'+e+'" should not include "#". Use "HashLocationStrategy" instead.');var n=q.firstMatch(t.RESERVED_CHARS,e);if(c(n))throw new Z('Path "'+e+'" contains "'+n[0]+'" which is not allowed in a route config.')},t}();Et.RESERVED_CHARS=q.create("//|\\(|\\)|;|\\?|=");var Ut=/%/g,zt=/\//g,Lt=/\(/g,Bt=/\)/g,Mt=/;/g,Wt=/%3B/gi,Ft=/%29/gi,qt=/%28/gi,Vt=/%2F/gi,Ht=/%25/gi,Qt=function(){function t(t,e){this._reString=t,this._serializer=e,this.terminal=!0,this.specificity="2",this.hash=this._reString,this._regex=q.create(this._reString)}return t.prototype.matchUrl=function(t){var e=t.toString(),n={},r=q.matcher(this._regex,e),i=V.next(r);if(h(i))return null;for(var o=0;o<i.length;o+=1)n[o.toString()]=i[o];return new It(e,[],n,[],null)},t.prototype.generateUrl=function(t){return this._serializer(t)},t.prototype.toString=function(){return this._reString},t}(),Jt=function(){function t(){this.rulesByName=new $,this.auxRulesByName=new $,this.auxRulesByPath=new $,this.rules=[],this.defaultRule=null}return t.prototype.config=function(t){var e;if(c(t.name)&&t.name[0].toUpperCase()!=t.name[0]){var n=t.name[0].toUpperCase()+t.name.substring(1);throw new Z('Route "'+t.path+'" with name "'+t.name+'" does not begin with an uppercase letter. Route names should be CamelCase like "'+n+'".')}if(t instanceof rt){e=new Ot(t.component,t.data);var r=this._getRoutePath(t),i=new At(r,e,t.name);return this.auxRulesByPath.set(r.toString(),i),c(t.name)&&this.auxRulesByName.set(t.name,i),i.terminal}var o=!1;if(t instanceof ot){var u=this._getRoutePath(t),a=new bt(u,t.redirectTo);return this._assertNoHashCollision(a.hash,t.path),this.rules.push(a),!0}t instanceof nt?(e=new Ot(t.component,t.data),o=c(t.useAsDefault)&&t.useAsDefault):t instanceof it&&(e=new St(t.loader,t.data),o=c(t.useAsDefault)&&t.useAsDefault);var s=this._getRoutePath(t),h=new At(s,e,t.name);if(this._assertNoHashCollision(h.hash,t.path),o){if(c(this.defaultRule))throw new Z("Only one route can be default");this.defaultRule=h}return this.rules.push(h),c(t.name)&&this.rulesByName.set(t.name,h),h.terminal},t.prototype.recognize=function(t){var e=[];return this.rules.forEach(function(n){var r=n.recognize(t);c(r)&&e.push(r)}),0==e.length&&c(t)&&t.auxiliary.length>0?[Q.resolve(new xt(null,null,t.auxiliary))]:e},t.prototype.recognizeAuxiliary=function(t){var e=this.auxRulesByPath.get(t.path);return c(e)?[e.recognize(t)]:[Q.resolve(null)]},t.prototype.hasRoute=function(t){return this.rulesByName.has(t)},t.prototype.componentLoaded=function(t){return this.hasRoute(t)&&c(this.rulesByName.get(t).handler.componentType)},t.prototype.loadComponent=function(t){return this.rulesByName.get(t).handler.resolveComponentType()},t.prototype.generate=function(t,e){var n=this.rulesByName.get(t);return h(n)?null:n.generate(e)},t.prototype.generateAuxiliary=function(t,e){var n=this.auxRulesByName.get(t);return h(n)?null:n.generate(e)},t.prototype._assertNoHashCollision=function(t,e){this.rules.forEach(function(n){if(t==n.hash)throw new Z("Configuration '"+e+"' conflicts with existing route '"+n.path+"'")})},t.prototype._getRoutePath=function(t){if(c(t.regex)){if(f(t.serializer))return new Qt(t.regex,t.serializer);throw new Z("Route provides a regex property, '"+t.regex+"', but no serializer property")}if(c(t.path)){var e=t instanceof rt&&t.path.startsWith("/")?t.path.substring(1):t.path;return new Et(e)}throw new Z("Route must provide either a path or regex property")},t}(),Gt=u.__core_private__.makeDecorator,$t=Gt(tt),Yt=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,u=3>o?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(u=(3>o?i(u):o>3?i(e,n,u):i(e,n))||u);return o>3&&u&&Object.defineProperty(e,n,u),u},Kt=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},Xt=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},Zt=Q.resolve(null),te=new u.OpaqueToken("RouterPrimaryComponent");t.RouteRegistry=function(){function t(t){this._rootComponent=t,this._rules=new $}return t.prototype.config=function(t,e){e=S(e,this),e instanceof nt?C(e.component,e.path):e instanceof rt&&C(e.component,e.path);var n=this._rules.get(t);h(n)&&(n=new Jt,this._rules.set(t,n));var r=n.config(e);e instanceof nt&&(r?k(e.component,e.path):this.configFromComponent(e.component))},t.prototype.configFromComponent=function(t){var e=this;if(p(t)&&!this._rules.has(t)){var n=u.reflector.annotations(t);if(c(n))for(var r=0;r<n.length;r++){var i=n[r];if(i instanceof tt){var o=i.configs;o.forEach(function(n){return e.config(t,n)})}}}},t.prototype.recognize=function(t,e){var n=lt.parse(t);return this._recognize(n,[])},t.prototype._recognize=function(t,e,n){var r=this;void 0===n&&(n=!1);var i=X.last(e),o=c(i)?i.component.componentType:this._rootComponent,u=this._rules.get(o);if(h(u))return Zt;var a=n?u.recognizeAuxiliary(t):u.recognize(t),s=a.map(function(t){return t.then(function(t){if(t instanceof xt){var n=e.length>0?[X.last(e)]:[],i=r._auxRoutesToUnresolved(t.remainingAux,n),o=new vt(t.instruction,null,i);

if(h(t.instruction)||t.instruction.terminal)return o;var u=e.concat([o]);return r._recognize(t.remaining,u).then(function(t){return h(t)?null:t instanceof _t?t:(o.child=t,o)})}if(t instanceof Pt){var o=r.generate(t.redirectTo,e.concat([null]));return new _t(o.component,o.child,o.auxInstruction,t.specificity)}})});return!h(t)&&""!=t.path||0!=a.length?Q.all(s).then(T):Q.resolve(this.generateDefault(o))},t.prototype._auxRoutesToUnresolved=function(t,e){var n=this,r={};return t.forEach(function(t){r[t.path]=new dt(function(){return n._recognize(t,e,!0)})}),r},t.prototype.generate=function(t,e,n){void 0===n&&(n=!1);var r,i=I(t);if(""==X.first(i))i.shift(),r=X.first(e),e=[];else if(r=e.length>0?e.pop():null,"."==X.first(i))i.shift();else if(".."==X.first(i))for(;".."==X.first(i);){if(e.length<=0)throw new Z('Link "'+X.toJSON(t)+'" has too many "../" segments.');r=e.pop(),i=X.slice(i,1)}else{var o=X.first(i),u=this._rootComponent,a=null;if(e.length>1){var s=e[e.length-1],l=e[e.length-2];u=s.component.componentType,a=l.component.componentType}else 1==e.length&&(u=e[0].component.componentType,a=this._rootComponent);var f=this.hasRoute(o,u),p=c(a)&&this.hasRoute(o,a);if(p&&f){var m='Link "'+X.toJSON(t)+'" is ambiguous, use "./" or "../" to disambiguate.';throw new Z(m)}p&&(r=e.pop())}if(""==i[i.length-1]&&i.pop(),i.length>0&&""==i[0]&&i.shift(),i.length<1){var m='Link "'+X.toJSON(t)+'" must include a route name.';throw new Z(m)}for(var g=this._generate(i,e,r,n,t),v=e.length-1;v>=0;v--){var y=e[v];if(h(y))break;g=y.replaceChild(g)}return g},t.prototype._generate=function(t,e,n,r,i){var o=this;void 0===r&&(r=!1);var u=this._rootComponent,a=null,f={},p=X.last(e);if(c(p)&&c(p.component)&&(u=p.component.componentType),0==t.length){var v=this.generateDefault(u);if(h(v))throw new Z('Link "'+X.toJSON(i)+'" does not resolve to a terminal instruction.');return v}c(n)&&!r&&(f=K.merge(n.auxInstruction,f),a=n.component);var y=this._rules.get(u);if(h(y))throw new Z('Component "'+s(u)+'" has no route config.');var d=0,R={};if(d<t.length&&l(t[d])){var w=t[d];if(""==w||"."==w||".."==w)throw new Z('"'+w+'/" is only allowed at the beginning of a link DSL.');if(d+=1,d<t.length){var x=t[d];m(x)&&!g(x)&&(R=x,d+=1)}var P=(r?y.auxRulesByName:y.rulesByName).get(w);if(h(P))throw new Z('Component "'+s(u)+'" has no route named "'+w+'".');if(h(P.handler.componentType)){var b=P.generateComponentPathValues(R);return new dt(function(){return P.handler.resolveComponentType().then(function(u){return o._generate(t,e,n,r,i)})},b.urlPath,_(b.urlParams))}a=r?y.generateAuxiliary(w,R):y.generate(w,R)}for(;d<t.length&&g(t[d]);){var A=[p],S=this._generate(t[d],A,null,!0,i);f[S.component.urlPath]=S,d+=1}var O=new vt(a,null,f);if(c(a)&&c(a.componentType)){var C=null;if(a.terminal)d>=t.length;else{var I=e.concat([O]),T=t.slice(d);C=this._generate(T,I,null,!1,i)}O.child=C}return O},t.prototype.hasRoute=function(t,e){var n=this._rules.get(e);return h(n)?!1:n.hasRoute(t)},t.prototype.generateDefault=function(t){var e=this;if(h(t))return null;var n=this._rules.get(t);if(h(n)||h(n.defaultRule))return null;var r=null;if(c(n.defaultRule.handler.componentType)){var i=n.defaultRule.generate({});return n.defaultRule.terminal||(r=this.generateDefault(n.defaultRule.handler.componentType)),new yt(i,r)}return new dt(function(){return n.defaultRule.handler.resolveComponentType().then(function(n){return e.generateDefault(t)})})},t}(),t.RouteRegistry=Yt([u.Injectable(),Xt(0,u.Inject(te)),Kt("design:paramtypes",[M])],t.RouteRegistry);var ee=function(){function t(t){this.name=t}return t}(),ne=function(){function t(t){this.fn=t}return t}(),re=new ee("routerCanReuse"),ie=new ee("routerCanDeactivate"),oe=new ee("routerOnActivate"),ue=new ee("routerOnReuse"),ae=new ee("routerOnDeactivate"),se=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,u=3>o?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(u=(3>o?i(u):o>3?i(e,n,u):i(e,n))||u);return o>3&&u&&Object.defineProperty(e,n,u),u},ce=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},he=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},le=Q.resolve(!0),fe=Q.resolve(!1);t.Router=function(){function t(t,e,n,r){this.registry=t,this.parent=e,this.hostComponent=n,this.root=r,this.navigating=!1,this.currentInstruction=null,this._currentNavigation=le,this._outlet=null,this._auxRouters=new $,this._subject=new G}return t.prototype.childRouter=function(t){return this._childRouter=new me(this,t)},t.prototype.auxRouter=function(t){return new me(this,t)},t.prototype.registerPrimaryOutlet=function(t){if(c(t.name))throw new Z("registerPrimaryOutlet expects to be called with an unnamed outlet.");if(c(this._outlet))throw new Z("Primary outlet is already registered.");return this._outlet=t,c(this.currentInstruction)?this.commit(this.currentInstruction,!1):le},t.prototype.unregisterPrimaryOutlet=function(t){if(c(t.name))throw new Z("registerPrimaryOutlet expects to be called with an unnamed outlet.");this._outlet=null},t.prototype.registerAuxOutlet=function(t){var e=t.name;if(h(e))throw new Z("registerAuxOutlet expects to be called with an outlet with a name.");var n=this.auxRouter(this.hostComponent);this._auxRouters.set(e,n),n._outlet=t;var r;return c(this.currentInstruction)&&c(r=this.currentInstruction.auxInstruction[e])?n.commit(r):le},t.prototype.isRouteActive=function(t){var e=this,n=this;if(h(this.currentInstruction))return!1;for(;c(n.parent)&&c(t.child);)n=n.parent,t=t.child;if(h(t.component)||h(this.currentInstruction.component)||this.currentInstruction.component.routeName!=t.component.routeName)return!1;var r=!0;return c(this.currentInstruction.component.params)&&K.forEach(t.component.params,function(t,n){e.currentInstruction.component.params[n]!==t&&(r=!1)}),r},t.prototype.config=function(t){var e=this;return t.forEach(function(t){e.registry.config(e.hostComponent,t)}),this.renavigate()},t.prototype.navigate=function(t){var e=this.generate(t);return this.navigateByInstruction(e,!1)},t.prototype.navigateByUrl=function(t,e){var n=this;return void 0===e&&(e=!1),this._currentNavigation=this._currentNavigation.then(function(r){return n.lastNavigationAttempt=t,n._startNavigating(),n._afterPromiseFinishNavigating(n.recognize(t).then(function(t){return h(t)?!1:n._navigate(t,e)}))})},t.prototype.navigateByInstruction=function(t,e){var n=this;return void 0===e&&(e=!1),h(t)?fe:this._currentNavigation=this._currentNavigation.then(function(r){return n._startNavigating(),n._afterPromiseFinishNavigating(n._navigate(t,e))})},t.prototype._settleInstruction=function(t){var e=this;return t.resolveComponent().then(function(n){var r=[];return c(t.component)&&(t.component.reuse=!1),c(t.child)&&r.push(e._settleInstruction(t.child)),K.forEach(t.auxInstruction,function(t,n){r.push(e._settleInstruction(t))}),Q.all(r)})},t.prototype._navigate=function(t,e){var n=this;return this._settleInstruction(t).then(function(e){return n._routerCanReuse(t)}).then(function(e){return n._canActivate(t)}).then(function(r){return r?n._routerCanDeactivate(t).then(function(r){return r?n.commit(t,e).then(function(e){return n._emitNavigationFinish(t.toRootUrl()),!0}):void 0}):!1})},t.prototype._emitNavigationFinish=function(t){J.callEmit(this._subject,t)},t.prototype._emitNavigationFail=function(t){J.callError(this._subject,t)},t.prototype._afterPromiseFinishNavigating=function(t){var e=this;return Q.catchError(t.then(function(t){return e._finishNavigating()}),function(t){throw e._finishNavigating(),t})},t.prototype._routerCanReuse=function(t){var e=this;return h(this._outlet)?fe:h(t.component)?le:this._outlet.routerCanReuse(t.component).then(function(n){return t.component.reuse=n,n&&c(e._childRouter)&&c(t.child)?e._childRouter._routerCanReuse(t.child):void 0})},t.prototype._canActivate=function(t){return E(t,this.currentInstruction)},t.prototype._routerCanDeactivate=function(t){var e=this;if(h(this._outlet))return le;var n,r=null,i=!1,o=null;return c(t)&&(r=t.child,o=t.component,i=h(t.component)||t.component.reuse),n=i?le:this._outlet.routerCanDeactivate(o),n.then(function(t){return 0==t?!1:c(e._childRouter)?e._childRouter._routerCanDeactivate(r):!0})},t.prototype.commit=function(t,e){var n=this;void 0===e&&(e=!1),this.currentInstruction=t;var r=le;if(c(this._outlet)&&c(t.component)){var i=t.component;r=i.reuse?this._outlet.reuse(i):this.deactivate(t).then(function(t){return n._outlet.activate(i)}),c(t.child)&&(r=r.then(function(e){return c(n._childRouter)?n._childRouter.commit(t.child):void 0}))}var o=[];return this._auxRouters.forEach(function(e,n){c(t.auxInstruction[n])&&o.push(e.commit(t.auxInstruction[n]))}),r.then(function(t){return Q.all(o)})},t.prototype._startNavigating=function(){this.navigating=!0},t.prototype._finishNavigating=function(){this.navigating=!1},t.prototype.subscribe=function(t,e){return J.subscribe(this._subject,t,e)},t.prototype.deactivate=function(t){var e=this,n=null,r=null;c(t)&&(n=t.child,r=t.component);var i=le;return c(this._childRouter)&&(i=this._childRouter.deactivate(n)),c(this._outlet)&&(i=i.then(function(t){return e._outlet.deactivate(r)})),i},t.prototype.recognize=function(t){var e=this._getAncestorInstructions();return this.registry.recognize(t,e)},t.prototype._getAncestorInstructions=function(){for(var t=[this.currentInstruction],e=this;c(e=e.parent);)t.unshift(e.currentInstruction);return t},t.prototype.renavigate=function(){return h(this.lastNavigationAttempt)?this._currentNavigation:this.navigateByUrl(this.lastNavigationAttempt)},t.prototype.generate=function(t){var e=this._getAncestorInstructions();return this.registry.generate(t,e)},t}(),t.Router=se([u.Injectable(),ce("design:paramtypes",[t.RouteRegistry,t.Router,Object,t.Router])],t.Router);var pe=function(t){function e(e,n,r){var i=this;t.call(this,e,null,r),this.root=this,this._location=n,this._locationSub=this._location.subscribe(function(t){i.recognize(t.url).then(function(e){c(e)?i.navigateByInstruction(e,c(t.pop)).then(function(n){if(!c(t.pop)||"hashchange"==t.type){var r=e.toUrlPath(),o=e.toUrlQuery();r.length>0&&"/"!=r[0]&&(r="/"+r),"hashchange"==t.type?e.toRootUrl()!=i._location.path()&&i._location.replaceState(r,o):i._location.go(r,o)}}):i._emitNavigationFail(t.url)})}),this.registry.configFromComponent(r),this.navigateByUrl(n.path())}return __extends(e,t),e.prototype.commit=function(e,n){var r=this;void 0===n&&(n=!1);var i=e.toUrlPath(),o=e.toUrlQuery();i.length>0&&"/"!=i[0]&&(i="/"+i);var u=t.prototype.commit.call(this,e);return n||(u=u.then(function(t){r._location.go(i,o)})),u},e.prototype.dispose=function(){c(this._locationSub)&&(J.dispose(this._locationSub),this._locationSub=null)},e}(t.Router);pe=se([u.Injectable(),he(2,u.Inject(te)),ce("design:paramtypes",[t.RouteRegistry,o.Location,M])],pe);var me=function(t){function e(e,n){t.call(this,e.registry,e,n,e.root),this.parent=e}return __extends(e,t),e.prototype.navigateByUrl=function(t,e){return void 0===e&&(e=!1),this.parent.navigateByUrl(t,e)},e.prototype.navigateByInstruction=function(t,e){return void 0===e&&(e=!1),this.parent.navigateByInstruction(t,e)},e}(t.Router),ge=Gt(ne),ve=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,u=3>o?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(u=(3>o?i(u):o>3?i(e,n,u):i(e,n))||u);return o>3&&u&&Object.defineProperty(e,n,u),u},ye=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},de=this&&this.__param||function(t,e){return function(n,r){e(n,r,t)}},_e=Q.resolve(!0);t.RouterOutlet=function(){function e(t,e,n,r){this._viewContainerRef=t,this._loader=e,this._parentRouter=n,this.name=null,this._componentRef=null,this._currentInstruction=null,this.activateEvents=new G,c(r)?(this.name=r,this._parentRouter.registerAuxOutlet(this)):this._parentRouter.registerPrimaryOutlet(this)}return e.prototype.activate=function(e){var n=this,r=this._currentInstruction;this._currentInstruction=e;var i=e.componentType,o=this._parentRouter.childRouter(i),a=u.ReflectiveInjector.resolve([u.provide(pt,{useValue:e.routeData}),u.provide(ft,{useValue:new ft(e.params)}),u.provide(t.Router,{useValue:o})]);return this._componentRef=this._loader.loadNextToLocation(i,this._viewContainerRef,a),this._componentRef.then(function(t){return n.activateEvents.emit(t.instance),N(oe,i)?n._componentRef.then(function(t){return t.instance.routerOnActivate(e,r)}):t})},e.prototype.reuse=function(t){var e=this._currentInstruction;return this._currentInstruction=t,h(this._componentRef)?this.activate(t):Q.resolve(N(ue,this._currentInstruction.componentType)?this._componentRef.then(function(n){return n.instance.routerOnReuse(t,e)}):!0)},e.prototype.deactivate=function(t){var e=this,n=_e;return c(this._componentRef)&&c(this._currentInstruction)&&N(ae,this._currentInstruction.componentType)&&(n=this._componentRef.then(function(n){return n.instance.routerOnDeactivate(t,e._currentInstruction)})),n.then(function(t){if(c(e._componentRef)){var n=e._componentRef.then(function(t){return t.destroy()});return e._componentRef=null,n}})},e.prototype.routerCanDeactivate=function(t){var e=this;return h(this._currentInstruction)?_e:N(ie,this._currentInstruction.componentType)?this._componentRef.then(function(n){return n.instance.routerCanDeactivate(t,e._currentInstruction)}):_e},e.prototype.routerCanReuse=function(t){var e,n=this;return e=h(this._currentInstruction)||this._currentInstruction.componentType!=t.componentType?!1:N(re,this._currentInstruction.componentType)?this._componentRef.then(function(e){return e.instance.routerCanReuse(t,n._currentInstruction)}):t==this._currentInstruction||c(t.params)&&c(this._currentInstruction.params)&&K.equals(t.params,this._currentInstruction.params),Q.resolve(e)},e.prototype.ngOnDestroy=function(){this._parentRouter.unregisterPrimaryOutlet(this)},e}(),ve([u.Output("activate"),ye("design:type",Object)],t.RouterOutlet.prototype,"activateEvents",void 0),t.RouterOutlet=ve([u.Directive({selector:"router-outlet"}),de(3,u.Attribute("name")),ye("design:paramtypes",[u.ViewContainerRef,u.DynamicComponentLoader,t.Router,String])],t.RouterOutlet);var Re=this&&this.__decorate||function(t,e,n,r){var i,o=arguments.length,u=3>o?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(u=(3>o?i(u):o>3?i(e,n,u):i(e,n))||u);return o>3&&u&&Object.defineProperty(e,n,u),u},we=this&&this.__metadata||function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0};t.RouterLink=function(){function t(t,e){var n=this;this._router=t,this._location=e,this._router.subscribe(function(t){return n._updateLink()})}return t.prototype._updateLink=function(){this._navigationInstruction=this._router.generate(this._routeParams);var t=this._navigationInstruction.toLinkUrl();this.visibleHref=this._location.prepareExternalUrl(t)},Object.defineProperty(t.prototype,"isRouteActive",{get:function(){return this._router.isRouteActive(this._navigationInstruction)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"routeParams",{set:function(t){this._routeParams=t,this._updateLink()},enumerable:!0,configurable:!0}),t.prototype.onClick=function(){return l(this.target)&&"_self"!=this.target?!0:(this._router.navigateByInstruction(this._navigationInstruction),!1)},t}(),t.RouterLink=Re([u.Directive({selector:"[routerLink]",inputs:["routeParams: routerLink","target: target"],host:{"(click)":"onClick()","[attr.href]":"visibleHref","[class.router-link-active]":"isRouteActive"}}),we("design:paramtypes",[t.Router,o.Location])],t.RouterLink);var xe=[t.RouteRegistry,{provide:o.LocationStrategy,useClass:o.PathLocationStrategy},o.Location,{provide:t.Router,useFactory:U,deps:[t.RouteRegistry,o.Location,te,u.ApplicationRef]},{provide:te,useFactory:z,deps:[u.ApplicationRef]}],Pe=[xe,{provide:o.PlatformLocation,useClass:a.BrowserPlatformLocation}],be=Pe,Ae=[t.RouterOutlet,t.RouterLink];t.ROUTER_DIRECTIVES=Ae,t.RouteParams=ft,t.RouteData=pt,t.ROUTER_PRIMARY_COMPONENT=te,t.CanActivate=ge,t.Instruction=gt,t.ComponentInstruction=Rt,t.OpaqueToken=u.OpaqueToken,t.ROUTER_PROVIDERS_COMMON=xe,t.ROUTER_PROVIDERS=Pe,t.ROUTER_BINDINGS=be,t.RouteConfig=$t,t.Route=nt,t.Redirect=ot,t.AuxRoute=rt,t.AsyncRoute=it});